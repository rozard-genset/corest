<!-- globvar -->
{{- $render := "" -}}

{{- $themes := "default" -}}
{{- with .Site.Params.System.Themes -}}{{- $themes = ( . | urlize ) -}}{{- end -}}

{{- $layout := "main" -}}
{{- with .Page.Params.Module.Layout -}}{{- $layout = ( . | urlize ) -}}{{- end -}}


<!-- models -->
{{- $based_basic := printf "themes/default/home/main/render.html" -}}
{{- $based_theme := printf "themes/%s/home/main/render.html" $themes -}}
{{- $based_model := printf "themes/%s/home/%s/render.html"   $themes $layout -}}


<!-- module -->
{{ range $based_basic $based_theme $based_model  }}
    {{- if templates.Exists ( printf "partials/%s" . ) -}}
        {{- $render = . -}}
    {{- end -}}
{{ end }}


<!-- blocks -->
{{- if .Page.Params.Blocks -}}
    {{- $render = printf "lib/blocks.html" -}}
{{- end -}}


<!-- render -->
{{- if templates.Exists ( printf "partials/%s" $render ) -}}
    {{- partial $render . -}}
{{- end -}}