<!-- render -->
{{- $render := "" -}}


<!-- themes -->
{{- $vars_themes := "default" -}}
{{- with .Site.Params.Themes -}}{{- $vars_themes = . -}}{{- end -}}


<!-- model -->
{{- $vars_models := "main" -}}
{{- with .Page.Params.Model -}}{{- $vars_model = . -}}{{- end -}}


<!-- module -->
{{- $based_core := printf "themes/default/model/page/main/main.html" -}}
{{- $based_skin := printf "themes/default/model/page/%s/main.html" $vars_models -}}

{{- $theme_core := printf "themes/%s/model/page/main/main.html" $vars_themes  -}}
{{- $theme_skin := printf "themes/%s/model/page/%s/main.html" $vars_themes $vars_models  -}}

{{- $modul_core := printf "module/%s/page/%s/main.html" .Section  $vars_models -}}
{{- $modul_skin := printf "themes/module/%s/page/%s/main.html" .Section  $vars_models -}}

{{- range ( slice $based_core $based_skin $theme_core $theme_skin $modul_core $modul_skin ) -}}
    {{- if templates.Exists ( printf "partials/%s" . )  -}}
        {{- $render = . -}}
    {{- end -}}
{{- end -}}


<!-- blocks -->
{{- with .Page.Params.Block  -}}
    {{- $render = printf "lib/blocks/render.html" -}}
{{- end -}}


<!-- process -->
{{ partial $render . }}