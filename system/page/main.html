<!-- render -->
{{- $render := "" -}}


<!-- themes -->
{{- $vars_themes := "default" -}}
{{- with .Site.Params.Themes -}}{{- $vars_themes = . -}}{{- end -}}


<!-- model -->
{{- $vars_model := "main" -}}
{{- with .Page.Params.Model -}}{{- $vars_model = . -}}{{- end -}}


<!-- module -->
{{- $based_core := printf "themes/default/model/page/main/main.html" -}}
{{- $based_skin := printf "themes/default/model/page/%s/main.html" $vars_model -}}
{{- $theme_core := printf "themes/%s/model/page/main/main.html" $vars_themes  -}}
{{- $theme_skin := printf "themes/%s/model/page/%s/main.html" $vars_themes $vars_model  -}}

{{- range ( slice $based_core $based_skin $theme_core $theme_skin ) -}}
    {{- if templates.Exists ( printf "partials/%s" . )  -}}
        {{- $render = . -}}
    {{- end -}}
{{- end -}}


<!-- blocks -->
{{- with .Page.Params.Block  -}}
    {{- $render = printf "lib/blocks/render.html" -}}
{{- end -}}


<!-- process -->
{{ partial $render . }}