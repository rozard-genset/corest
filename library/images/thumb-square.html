{{- $image := "" -}}

{{- if .Page.Params.Metadata.thumb -}}
    {{- $image = .Page.Resources.GetMatch .Page.Params.Metadata.thumb -}}
{{- end -}}

{{- if .Page.Params.Module.Cover.Image -}}
    {{- $image = .Page.Resources.GetMatch .Page.Params.Module.Cover.Image -}}
{{- end -}}

{{- if $image -}}
    <picture>
        {{- $xs := $image.Resize "480x480 webp q100" -}}
        <source media="(width < 481px)" srcset="{{ $xs.RelPermalink }}" fetchpriority="high" />

        {{- $sm := $image.Resize "620x620 webp q100" -}}
        <source media="(width < 620px)" srcset="{{ $sm.RelPermalink }}" fetchpriority="high" />

        {{- $md := $image.Resize "768x768 webp q100" -}}
        <source media="(width < 768px)" srcset="{{ $md.RelPermalink }}" fetchpriority="high" />

        {{- $lg := $image.Resize "1028x1028 webp q100" -}}
        <source media="(width < 1028px)" srcset="{{ $sm.RelPermalink }}" fetchpriority="high" />

        {{- $xl := $image.Resize "1280x1280 webp q100" -}}
        <source media="(width < 1280px)" srcset="{{ $sm.RelPermalink }}" fetchpriority="high" />

        <img src="{{ $xl.RelPermalink }}" alt="{{ .Title }}" class="thumb-square" width="{{ $xl.Width }}" height="{{ $xl.Height }}" title="{{ .Title }}" fetchpriority="high"/>
    </picture>
{{- end -}}