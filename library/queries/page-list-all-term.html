<!-- populate term -->
{{- $get_term := slice -}}
{{- $set_term := .Site.GetPage ( printf "%s/terms" .Section ) -}}
{{- $set_page := where .Site.RegularPages "Type" .Section -}}

{{- range $set_term.Pages -}}
    {{- if eq .Page.Params.Module.Layout "term" -}}
        {{- $get_term = $get_term | append . -}}
    {{- end -}}
{{- end -}}


<!-- populate page -->
{{- $all_term := $get_term | uniq -}}
{{- $all_page := slice -}} 

{{- range $all_term -}}
    {{- $page_now := .Title -}}
    {{- $term_now := slice ( .Title | urlize ) -}}
    {{- $page_map := slice   -}}
    {{- range $set_page -}}
        {{- if collections.Intersect $term_now .Page.Params.terms -}}
            {{- $page_map = $page_map | append . -}}
        {{- end -}}
    {{- end -}}
    {{- $all_page = $all_page | append ( dict "name" $page_now  "page" . "list" $page_map ) -}}
{{- end -}}

{{- return $all_page -}}